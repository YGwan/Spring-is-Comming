# spring-is-coming

#### Spring framework를 다루기 위한 기본부터 시작하기

<br>

- Http 
- HttpServlet 직접 구현해보기
- SpringMVC
- JDBC
- Spring JDBC
- JWT를 사용한 인증 구현
- KeyHolder를 사용한 자동 id값 생성
- ExceptionHandler, ControlerAdvice를 사용한 에러 처리 구현

---
### 개발 환경 선택 이유

<br>

#### Gradle - Groovy Project 선택 이유

- XML 기반 스크립트에 비해 관리가 편하기 때문에 사용 (Groovy 문법으로 간결한 스크립트 작성 가능)
- 캐싱을 통한 빌드 속도가 빠르다.
- 안드로이드 프로젝트의 표준 빌드 시스템으로 채택되어 있다.
- 현재는 Maven -> Gradle로 넘어가는 추세이기 때문에

<br>

#### java 11 버전 사용 이유
- LTS를 지원하는 버전이므로
- Stream, Lambda 등을 지원하는 버전 중 적당한 시기에 나왔고 어느정도 안정성을 보장하는 버전이기 때문에
- spring과의 호환성이 좋기 때문에

---

### 스프링 웹 개발 기초
- 정적 컨텐츠(모놀리식)
  - html 파일 자체를 그대로 웹브라우저에게 전달해주는 방식 

- MVC & 템플릿 엔진
  - MVC(Model, View, Controller)로 세분화하여 개발
  - 서버에서 html에 값을 전달해 변형 후 전달  


- API
  - JSON과 같은 데이터 구조로 데이터 전달 

**요즘에는 API 방식으로 서버를 주로 개발한다.**

---

### 일반적인 스프링 계층 구조

<br>

<p align="center">
<img width="540" alt="스크린샷 2023-04-24 오후 4 46 49" src="https://user-images.githubusercontent.com/50222603/233932088-b9802eba-1781-4927-b6a8-5e9cca988a6e.png">
</p>

<br>

1. controller : 웹 MVC의 컨트롤러 역할, 주로 사용자의 요청을 받아 처리하고 응답하는 일련의 과정을 담당한다.
2. service : 핵심 비즈니스 로직을 구현한다.
3. repository : 데이터베이스에 접근하고 도메인 객체를 DB에 저장 & 관리한다. Entity에 의해 생성된 DB에 접근하는 메서드 들을 사용하기 위한 인터페이스입니다. 
4. domain : 비즈니스 도메인 객체, entity 집합체라고 생각할 수 있다.
5. dto : data transfer object의 약자로, 계층 간 데이터 전송을 담당하는 객체이다.
6. dao : data access object의 약자로, 실제 DB에 접근해 일련의 로직을 처리하는 객체이다.

---

### 스프링을 빈에 등록하는 방법
- ComponentScan을 통해 자동으로 등록하게끔 구현하는 방법
  - 원리
    - 스프링이 시작되면 @ComponentScan 어노테이션이 있거나, 해당 어노테이션을 포함하는 다음 어노테이션을 스캔한뒤, 스프링 빈으로 자동 등록한다. (@Controller, @Service, @Repository 등)
    - 해당 어노테이션이 작성된 패키지 이하의 클래스들을 순회하며 빈으로 등록될 객체들을 탐색한다.(@SpringBootApplication)

<br>

- @Bean을 사용해 자바 코드로 직접 스프링 빈에 등록하는 방법
  - 주로 Config 파일에서 진행한다.
  - 상황에 따라 구현 클래스를 변경해야 하면 자바 코드로 직접 Spring Bean으로 등록하는 것이 좋다. (그때 그때 바꾸기 수월하기 때문에)

---

### 스프링 DB 접근 기술

<br>

- jdbc(java database Connectivity)
  - 자바에서 DB 프로그래밍을 하기 위해 사용되는 API
  - 데이터베이스 종류에 상관이 없다.(DB 연결은 DB 종류에 맞는 Driver를 사용하면 되기 때문에)
  - jdbc 동작 흐름
    - jdbc 드라이버 로드 -> DB 연결 -> DB에 데이터 읽기 & 쓰기 -> ResultSet으로 결과 받아오기 -> close()

<br>

- spring Jdbc
  - jdbc의 connection 문제, 코드가 너무 길어지는 문제를 해결하기 위해 등장했다.
  - DataSource만 JdbcTemplate에 제공하면 위에서 사용한 JDBC 코드들을 자동으로 처리해준다.
  - JDBC 프로그래밍을 위해 JdbcTemplate 클래스를 제공하여 JdbcTemplate 클래스를 사용해 손쉽게 DB와 연동할 수 있도록 구현되어 있다.
  -  jdbcTemplate 클래스에서 제공하는 메서드를 사용하기 때문에 코드가 간결해지고 더 쉽다.

<br>

- JPA(java persistence api)
  - 자바 어플리케이션에서 관계형 데이터베이스를 사용하는 방식을 정의한 인터페이스   
  - OOP와 RDBMS의 패러다임의 불일치를 해결하기 위해 사용
  - 기존의 반복 코드 + 기본적인 SQL도 JPA가 직접 만들어준다. -> 개발자가 비즈니스 로직에 더 집중할 수 있게 해준다.
  - entityManager을 사용해 엔티티를 저장하고, 수정하고, 삭제하고 조회하는 등 엔티티와 관련된 모든 일을 처리한다.

<br>

- spring data JPA
  - 스프링 데이터 JPA는 JPA를 편리하게 사용하도록 도와주는 기술이다.
  - JPA보다 더 간편하게 repository에 구현 클래스 없이 인터페이스 만으로 개발을 할 수 있게 해준다.
  - 기본 CRUD 기능을 제공한다.
  - JPA의 기본지식이 없는 상태에서 spring data JPA를 학습하면 안된다.

---

### IOC & Spring DI

- #### IOC(Inversion of Control)
  - 제어의 역전
  - 메서드나 객체의 생성 & 호출 작업을 개발자가 하는 것이 아니라 외부에서 결정되게 하는것
  - new를 통해 객체를 생성하는 것이 아닌 스프링에서 관리하는 Bean에 자동으로 생성된 객체들을 가져와 사용하는 방식

<br>

- #### Spring DI(Dependency Injection)
  - 의존성 주입
  - 스프링에서 의존성 주입(DI)란, 객체간 의존성을 개발자가 객체 내부에서 직접 호출(new 연산자)하는 대신, 외부(스프링 컨테이너)에서 객체를 생성해서 넣어주는 방식을 말한다.
  - 인터페이스를 사이에 두어 클래스 레벨에서는 의존관계가 고정되지 않도록 하고, 런타임 시 관계를 동적으로 주입하여 유연성을 확보하고 결합도를 낮출 수 있게 한다.
  - 두 객체간의 관계를 맺어주는 것을 의존성 주입이라고 하며 스프링에서는 3가지 방법의 의존성 주입방법이 있다.
    - 생성자 주입
        - 생성자에 @AutoWired를 붙여 의존성을 주입받을 수 있다.
        - 생성자 주입은 인스턴스 생성 시 1회 호출되는 것이 보장되기 때문에, 주입 받은 객체가 변하지 않거나, 반드시 객체 주입이 필요한 경우 강제하기 위해 사용된다.
        - 테스트 용의, 객체 불변성 확보(final 선언 가능), 순환 참조 에러 발생 시 컴파일 단계에서 판단이 가능하다는 여러 장점이 있다.


    - 필드 주입
      - 의존 관계를 정확히 파악하기가 힘들다.
      - 외부에서 변경이 불가능해 테스트하기 힘들다.
      - 주입이 동시에 일어나 겹치는 경우 순환참조 에러가 발생한다.


    - 수정자(setter) 주입
      - 스프링 3.x대 버전에서 추천되었던 방식으로, 현재는 주입받는 객체가 변경될 가능성이 있는 경우에만 사용되는 방식이다.

<br>

**따라서 현재 이러한 이유로 생성자 주입 방식을 주로 사용한다.**

  



